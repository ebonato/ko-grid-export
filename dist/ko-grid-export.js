/*
 Copyright (c) 2015, Ben Schulz
 License: BSD 3-clause (http://opensource.org/licenses/BSD-3-Clause)
*/
function f(g){return function(g,h){function m(b){var e=b.columns.displayed().filter(function(a){return!!a.property}),d=b.data.valueSelector;b.data.source.streamValues(function(a){return a.filteredBy(b.data.predicate).sortedBy(b.data.comparator)}).then(function(a){return a.map(function(a){return"<tr>"+e.map(function(c){return"<td>"+d(-1==c.property.indexOf(".")?a[c.property]:eval("value."+c.property))+"</td>"}).join("")+"</tr>"}).reduce(function(a,c){return a+c},"")}).then(function(a){a=['<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">  <head></head>  <body>    <table>      <thead>',
"        <tr>"+e.map(function(a){return"<th>"+a.label()+"</th>"}).join("")+"</tr>","      </thead>      <tbody>",a,"      </tbody>    </table>  </body></html>"].join("");(window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob.bind(window.navigator):function(a,c){var b=k.createObjectURL(a);a=l.createElement("a");a.href=b;a.download=c;c=l.createEvent("MouseEvents");c.initEvent("click",!0,!0);a.dispatchEvent(c);window.setTimeout(function(){return k.revokeObjectURL(b)})})(new n([a],{type:"application/vnd.ms-excel;charset=utf-8"}),
"excel-export.xls")})}var l=window.document,n=window.Blob,k=window.URL;h.defineExtension("ko-grid-export",{dependencies:["ko-grid-toolbar"],initializer:function(b){b.into("left-toolbar").insert(' <button class="ko-grid-toolbar-button ko-grid-excel-export">Excel Export</button> ')},Constructor:function(b,e,d){d.rootElement.addEventListener("click",function(a){a.target.classList.contains("ko-grid-excel-export")&&m(d)})}});return h.declareExtensionAlias("export","ko-grid-export")}({},g)}
"function"===typeof define&&define.amd?define(["ko-grid","ko-data-source","ko-indexed-repeat","knockout"],f):window["ko-grid-export"]=f(window.ko.bindingHandlers.grid);